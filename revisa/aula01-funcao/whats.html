<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-sm">
                Digite a mensagem <input type="text" class="form-control" id="mensagem">
            </div>
            <div class="col-sm">
                Digite o link <input type="text" value="https://www.google.com/" class="form-control" id="copiarLink" onclick="copyToClipboard()">
            </div>
            <div class="col-sm">
                Digite o celular <input type="text" value="5551991640596" class="form-control" id="telefoneWhatsOtimizado">
            </div>
            <div class="col-sm">
                <img id='whatsOtimizado' src='./send.png' width='25px' style='cursor:pointer' onclick='loadSendOtimizado();'>
            </div>

            <p id="info"></p>
            <a id="link" href="" target="_blank">Enviar para</a>

        </div>
    </div>
    <script> 
        function loadSendOtimizado(){
            var mensagem = document.getElementById('mensagem').value;
            var link = document.getElementById('copiarLink').value;
            var numero = document.getElementById('telefoneWhatsOtimizado').value;

            console.log('Mensagem = '+mensagem);
            console.log('Link = '+link);
            console.log('Número = '+numero);

            //desativando o botão
            document.getElementById('whatsOtimizado').removeAttribute("onclick");
            document.getElementById('whatsOtimizado').setAttribute('style', 'cursor:wait');
            document.getElementById('whatsOtimizado').src = './check.png';

            var url = 'https://api.whatsapp.com/send?phone=';
            console.log('url '+url);
            
            url = url + numero;
            console.log('url '+url);

            url = url + "&text=";
            console.log('url '+url);

            var msgCompleta = "Prezado *cliente* ";
            msgCompleta = msgCompleta + mensagem ;
            msgCompleta = msgCompleta + link;

            url = url + msgCompleta;

            console.log('url '+url);

            //document.getElementById('info').innerHTML = url;

            document.getElementById('link').innerHTML += " "+numero;
            document.getElementById('link').href = url;
            
            //ativando o botão novamente

        }
        function copyToClipboard(){
            var copyText  = document.getElementById("copiarLink");
            copyText.select(); //select the text
            copyText.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(copyText.value);
            console.log(copyText.value);
        }
    </script>
</body>
</html>